#include <stdio.h>
#include <time.h>

typedef struct
{
	int hour;
	int minute;
} timetable;

void ptimetable( timetable a[], int n );
int outputhour( void );
int outputminu( void );
void next3( timetable a[],int n );

int main( void )
{
	int ans1 = 0;
	int ans2 = 0;
	char name [21] ;
	FILE*fp;

	timetable dayA[ 81 ] = { { 5,38}, { 5,58}, { 6,25}, { 6,38}, { 6,49}, { 7, 2}, { 7,10}, { 7,18}, { 7,26}, { 7,34},
							 { 7,42}, { 7,49}, { 7,58}, { 8, 5}, { 8,14}, { 8,26}, { 8,41}, { 8,51}, { 9, 4}, { 9,17},
							 { 9,30}, { 9,45}, {10, 0}, {10,15}, {10,30}, {10,45}, {11, 0}, {11,15}, {11,30}, {11,45},
							 {12, 0}, {12,15}, {12,30}, {12,45}, {13, 0}, {13,15}, {13,30}, {13,45}, {14, 0}, {14,15},
							 {14,30}, {14,45}, {15, 3}, {15,15}, {15,33}, {15,48}, {16, 3}, {16,18}, {16,33}, {16,48},
							 {17, 3}, {17,13}, {17,28}, {17,43}, {17,58}, {18,13}, {18,28}, {17,43}, {17,58}, {18,13},
							 {18,28}, {18,42}, {18,58}, {19,14}, {19,21}, {19,30}, {19,46}, {20, 1}, {20,10}, {20,26},
							 {20,42}, {21, 0}, {21,11}, {21,32}, {21,44}, {21,56}, {22,19}, {22,32}, {22,44}, {23, 8} };
	
	timetable holidayA[ 68 ] = { { 5,38}, { 5,59}, { 6,20}, { 6,37}, { 6,53}, { 7, 9}, { 7,25}, { 7,39}, { 7,50}, { 8, 4},
								 { 8,16}, { 8,28}, { 8,42}, { 8,59}, { 9,12}, { 9,29}, { 9,42}, { 9,59}, {10,12}, {10,29},
								 {10,42}, {11,29}, {11,12}, {11,59}, {12,12}, {12,29}, {12,42}, {12,59}, {13,12}, {13,29},
								 {13,42}, {13,59}, {14,12}, {14,29}, {14,42}, {14,59}, {15,12}, {15,29}, {15,42}, {15,59}, 
								 {16,12}, {16,29}, {16,42}, {16,59}, {17,12}, {17,29}, {17,42}, {17,59}, {18,12}, {18,29}, 
								 {18,42}, {18,59}, {19,12}, {19,29}, {19,42}, {19,59}, {20,12}, {20,29}, {20,42}, {20,59},
								 {21,12}, {21,29}, {21,42}, {21,56}, {22,17}, {22,31}, {22,44}, {23, 8} 				   };
	
	timetable dayB[ 80 ] = { { 5,31}, { 5,48}, { 5,58}, { 6,13}, { 6,23}, { 6,38}, { 6,50}, { 7, 3}, { 7,17}, { 7,21},
							 { 7,33}, { 7,38}, { 7,54}, { 8, 6}, { 8,12}, { 8,24}, { 8,34}, { 8,47}, { 9, 1}, { 9,19},
							 { 9,28}, { 9,40}, {10, 0}, {10,20}, {10,30}, {10,50}, {11, 0}, {11,20}, {11,30}, {11,50},
							 {12, 0}, {12,20}, {12,30}, {12,50}, {13, 0}, {13,20}, {13,30}, {13,50}, {14, 0}, {14,20},
							 {14,20}, {14,30}, {14,50}, {15, 0}, {15,20}, {15,30}, {15,50}, {16,00}, {16,20}, {16,34},
							 {16,45}, {17, 0}, {17,14}, {17,14}, {17,34}, {17,46}, {18, 1}, {18,14}, {18,21}, {18,34},
							 {18,47}, {19, 0}, {19,20}, {19,29}, {19,44}, {20, 1}, {20,16}, {20,29}, {20,44}, {21, 0},
							 {21,20}, {21,35}, {21,51}, {22,10}, {22,19}, {22,33}, {22,42}, {22,51}, {23,23}, {23,33} };

	timetable holidayB[ 72 ] = { { 5,58}, { 6,20}, { 6,38}, { 7, 0}, { 7,10}, { 7,19}, { 7,29}, { 7,50}, { 8, 0}, { 8,20},
								 { 8,30}, { 8,50}, { 9, 0}, { 9,20}, { 9,30}, { 9,40}, {10, 0}, {10,10}, {10,30}, {10,40},
								 {11,00}, {11,10}, {11,30}, {11,40}, {12, 0}, {12,10}, {12,30}, {12,40}, {13, 0}, {13,10},
								 {13,10}, {13,30}, {13,40}, {14, 0}, {14,10}, {14,30}, {14,40}, {15, 0}, {15,10}, {15,30}, 
								 {15,40}, {16, 0}, {16,10}, {16,30}, {16,40}, {17, 0}, {17,10}, {17,30}, {17,40}, {18, 0},
								 {18,10}, {18,30}, {18,40}, {19, 0}, {19,10}, {19,35}, {19,44}, {20, 0}, {20,17}, {20,34},
								 {20,41}, {20,50}, {21, 7}, {21,15}, {21,31}, {21,41}, {21,50}, {21,58}, {22,21}, {22,32},
								 {22,50}, {23,23}                                                                         };
 
	printf( "ò…‰w Ì ‘å‘]ª‰w\n" );

	while ( ans1 != 1 && ans1 != 2 && ans2 != 1 && ans2 != 2 )
	{
		printf( "”š‚ğ‘I‘ğ‚µ‚Ä‚­‚¾‚³‚¢B\n1.•½“ú 2.“y“új\n" );
		scanf( "%d", &ans1 );
		printf( "”š‚ğ“ü—Í‚µ‚Ä‚­‚¾‚³‚¢B \n1.ò…”­ 2.‘å‘]ª”­\n" );
		scanf( "%d", &ans2 );
	}

	if( ans1 == 1 )
	{
		printf( "•½“úƒ_ƒCƒ„\n" );
		if( ans2 == 1 )
		{
			printf( "ò…”­( ò… ¨ ‘å‘]ª )\n" );
			printf( " Œ»İ    %2d:%2d\n", outputhour( ), outputminu( ) );
			next3( dayA, 80 );
		}
		else if( ans2 == 2 )
		{
			printf( "‘å‘]ª”­( ‘å‘]ª ¨ ò… )\n" );
			printf( " Œ»İ    %2d:%2d\n", outputhour( ), outputminu( ) );
			next3( dayB, 80 );
		}
	}
	else if( ans1 == 2 )
	{
		printf( "“y“újƒ_ƒCƒ„\n" );
		if( ans2 == 1 )
		{
			printf( "ò…”­( ò… ¨ ‘å‘]ª )\n" );
			printf( " Œ»İ    %2d:%2d\n", outputhour( ), outputminu( ) );
			next3( holidayA, 68 );
		}
		else if( ans2 == 2 )
		{
			printf( "‘å‘]ª”­( ‘å‘]ª ¨ ò… )\n" );
			printf( " Œ»İ    %2d:%2d\n", outputhour( ), outputminu( ) );
			next3( holidayB, 72 );
		}
	}
	printf( "—˜—pÒ‚Ì–¼‘O‚ğ“ü—Í‚µ‚Ä‚­‚¾‚³‚¢\n" );
	scanf("%s",name);
	if( ( fp=fopen("input.txt","a") ) == NULL )
	{
		printf("ƒtƒ@ƒCƒ‹ƒI[ƒvƒ“ƒGƒ‰[\n");
		exit(0);
	}

	fprintf(fp,"%s \n",name);
	fclose(fp);

	return 0;
}

void ptimetable( timetable a[], int n )
{
	printf( "”­Ô\n  •ª\n" );
	for ( int i = 0; i < n; i++ )
	{
		printf( "%d %d \n", a[i].hour, a[i].minute );
	}
}

int outputhour ( void )
{
	time_t timer = time( NULL );
	struct tm *local = localtime( &timer );
	return local -> tm_hour;
	
}
int outputminu( void )
{
	time_t timer = time( NULL );
	struct tm *local = localtime( &timer );
	return local -> tm_min;
}

void next3( timetable a[], int n )
{
	int h = outputhour( );
	int m = outputminu( );
	int count = 0;

	for( int i = 0; i < n; i++ )
	{
		if( a[i].hour >= h && a[i].minute >= m )
		{
			printf( "”­Ô %d\n%2d:%2d\n", count+1, a[i].hour, a[i].minute );
			count++;
		}

		if( count > 2 )
		{
			return;
		}
	}
	if( count == 0 )
	{
		for( int i = 0; i < 3; i++ )
		{
			printf( "”­Ô %d\n%2d:%2d\n", count+1, a[i].hour, a[i].minute );
			count++;

		}
	}
	else if( count == 1 )
	{
		for( int i = 0; i < 2; i++ )
		{
			printf( "”­Ô %d\n%2d:%2d\n", count+1, a[i].hour, a[i].minute );
			count++;

		}
	}
	else if( count == 2 )
	{
		for( int i = 0; i < 1; i++ )
		{
			printf( "”­Ô %d\n%2d:%2d\n", count+1, a[i].hour, a[i].minute );
			count++;

		}
	}
	
}

